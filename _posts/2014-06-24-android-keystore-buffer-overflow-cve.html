---
layout: post
title: Android KeyStore Buffer Overflow (CVE-2014-3100)
date: '2014-06-24T11:42:00.000+03:00'
author: Roee Hay
tags: 
modified_time: '2014-06-30T13:26:13.892+03:00'
---

We have discovered a stack-based buffer overflow in the <b>Android KeyStore</b> service which affects Android 4.3.<br>
The issue was patched in Android 4.4.<br>
As an anecdote, the vulnerable source code contains the following comment:<br><br>
{% highlight C %}
/* KeyStore is a secured storage for key-value pairs. In this implementation, 
 * each file stores one key-value pair. Keys are encoded in file names, and
 * values are encrypted with checksums. The encryption key is protected by a 
 * user-defined password. To keep things simple, buffers are always larger than 
 * the maximum space we needed, so boundary checks on buffers are omitted. 
 */ 
{% endhighlight %}
 Though things are simple, buffers are not always larger than the maximum space they needed. The vulnerability is identified as CVE-2014-3100.
 <br><br>
 More details are available at:<br>
 1. Blog post: <a href="http://ibm.co/1pbk4yH">http://ibm.co/1pbk4yH</a><br>
 2. Advisory: <a href="http://slidesha.re/1nxBnmY">http://slidesha.re/1nxBnmY
