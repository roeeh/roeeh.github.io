---
layout: post
title: 'Android DNS Poisoning: Randomness gone bad (CVE-2012-2808)'
date: '2012-07-24T18:29:00.001+03:00'
author: Roee Hay
tags: 
modified_time: '2012-07-28T22:05:06.371+03:00'
thumbnail: https://img.youtube.com/vi/ffnF7Jej7l0/default.jpg
---

Recently we (together with Roi Saltzman) discovered a very interesting vulnerability in Androidâ€™s DNS resolver, a weakness&nbsp;<span style="background-color: white;">in its pseudo-random number generator (PRNG), which makes DNS poisoning attacks feasible.</span><br /><br />The PRNG that the DNS resolver uses is<br /><div align="center"><span style="font-family: 'Courier New';"><img border="0" src="http://chart.googleapis.com/chart?cht=tx&amp;chl=random_%7bid%7d%3dWORD(time_%7b%5cmu+sec%7d%5coplus+time_%7bsec%7d%5coplus+pid)" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" /></span></div>It can be seen that it returns a value that directly depends on the current time.<br /><br />Both the TXID and source port values are generated by this PRNG. &nbsp;Since both calls to the PRNG function occur successively, the returned values are very much correlated to each other. This yields a feasible attack expected time as shown in our whitepaper.<br /><br /><b>Important links:</b><br /><ol><li>Original blog post: <a href="https://bitly.com/MkoU5j" title="https://bitly.com/MkoU5j">https://bitly.com/MkoU5j</a></li><li>Whitepaper with full details: <a href="http://bit.ly/MkteBx" title="http://bit.ly/MkteBx">http://bit.ly/MkteBx</a></li></ol><div><br /></div><b>Video demo of the PoC:</b><br /><div class="separator" style="clear: both; text-align: center;"><iframe allowfullscreen="" frameborder="0" height="315" src="http://www.youtube.com/embed/ffnF7Jej7l0" style="background-color: white;" width="420"></iframe></div>
