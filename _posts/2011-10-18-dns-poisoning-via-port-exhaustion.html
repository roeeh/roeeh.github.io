---
layout: post
title: DNS poisoning via Port Exhaustion
date: '2011-10-18T23:02:00.001+02:00'
author: Roee Hay
tags: 
modified_time: '2011-10-18T23:02:00.797+02:00'
thumbnail: https://img.youtube.com/vi/eSEvFmsw55A/default.jpg
---

<p>We have just released a very interesting whitepaper which describes a DNS poisoning attack against stub resolvers.</p>  <p>It discloses two vulnerabilities:</p>  <ol>   <li>A vulnerability in <strong>Java</strong> (CVE-2011-3552, CVE-2010-4448) which enables <em>remote</em> DNS poisoning using Java applets. This vulnerability can be triggered when opening a malicious webpage. A successful exploitation of this vulnerability may lead to disclosure and manipulation of cookies and web pages, disclosure of NTLM credentials and clipboard data of the logged-on user, and even firewall bypass. </li>    <li>A vulnerability in multiuser <strong>Windows</strong> environments which enables <em>local</em> DNS cache poisoning of arbitrary domains. This&#160; vulnerability can be triggered by a normal user (i.e. one with non-administrative rights) in order to attack other users of the system. A successful exploitation of this vulnerability may lead to information disclosure, privilege escalation, universal XSS and more. </li> </ol>  <p>The whitepaper can be found <a title="DNS poisoning via Port Exhaustion whitepaper" href="http://bit.ly/q31wSq">here</a><strong></strong>.</p>  <p>A few video demos of our Proof-of-Concept:</p>  <ol>   <li>Attack: Remote DNS poisoning via Java Applets: Cookie theft.      <br />Environment: Ubuntu 11.04, Firefox 7.0.1.       <br />      <br /><iframe height="315" src="http://www.youtube.com/embed/eSEvFmsw55A?rel=0&amp;hd=1" frameborder="0" width="420"></iframe>      <br /></li>    <li>Attack: Remote DNS poisoning via Java Apples: NTLM credentials and Clipboard theft.      <br />Environment: Windows 2008, Internet Explorer 9.       <br />      <br /><iframe height="315" src="http://www.youtube.com/embed/i-Fmk7-pFFA?rel=0&amp;hd=1" frameborder="0" width="420"></iframe></li>    <li>Attack: Remote DNS poisoning via Java Applets: Firewall bypass.      <br />Environment: Windows 2008, Firefox 7.0.1.       <br />      <br /><iframe height="315" src="http://www.youtube.com/embed/7CFq_pofeBU?rel=0&amp;hd=1" frameborder="0" width="420"></iframe></li>    <li>Attack: Local DNS poisoning via port exhaustion.      <br />Environment: Windows 2008.       <br />      <br /><iframe height="315" src="http://www.youtube.com/embed/m2GkLL9d68E?rel=0&amp;hd=1" frameborder="0" width="420"></iframe></li> </ol>  <p>We would like to thank Oracle and Microsoft for their cooperation.</p>  <p>-Roee Hay and Yair Amit</p>  
